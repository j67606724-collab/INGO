import pandas as pd

file_path = 'Калькулятор (последний релиз) (2).xlsm'

# Load the sheet
sheet = pd.read_excel(file_path, engine='openpyxl')

# Extract discount values from A15 and C15
# A15 is row 14, column 0; C15 is row 14, column 2

discount_A15 = sheet.iat[14, 0]
discount_C15 = sheet.iat[14, 2]

html_content = f'''\
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ипотечный калькулятор</title>
<style>
  body {{ font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }}
  label {{ display: block; margin-top: 10px; }}
  input, select {{ width: 100%; padding: 8px; margin-top: 5px; }}
  button {{ margin-top: 15px; padding: 10px 15px; font-size: 16px; }}
  .result {{ margin-top: 20px; font-weight: bold; }}
</style>
</head>
<body>
<h1>Ипотечный калькулятор</h1>
<label for="loanAmount">Сумма кредита (руб):</label>
<input type="number" id="loanAmount" value="1000000" min="0" step="1000">

<label for="age">Возраст клиента:</label>
<input type="number" id="age" value="30" min="18" max="100">

<label>Риски страхования:</label>
<label><input type="checkbox" id="riskProperty"> Имущество</label>
<label><input type="checkbox" id="riskTitle"> Титул</label>
<label><input type="checkbox" id="riskLife"> Жизнь</label>

<button onclick="calculatePremium()">Рассчитать</button>

<div class="result" id="result"></div>

<script>
  const discountA15 = {discount_A15};
  const discountC15 = {discount_C15};

  function calculatePremium() {{
    const loanAmount = parseFloat(document.getElementById('loanAmount').value);
    const age = parseInt(document.getElementById('age').value);
    const riskProperty = document.getElementById('riskProperty').checked;
    const riskTitle = document.getElementById('riskTitle').checked;
    const riskLife = document.getElementById('riskLife').checked;

    if (loanAmount <= 0) {{
      alert('Введите корректную сумму кредита');
      return;
    }}
    if (age < 18 || age > 100) {{
      alert('Введите корректный возраст клиента');
      return;
    }}

    let premium = 0;

    if (riskProperty) premium += loanAmount * 0.01 * discountA15;
    if (riskTitle) premium += loanAmount * 0.005 * discountA15;
    if (riskLife) premium += loanAmount * 0.015 * discountC15;

    document.getElementById('result').innerText = `Страховая премия: ${premium.toFixed(2)} руб.`;
  }}
</script>
</body>
</html>
'''

with open('index.html', 'w', encoding='utf-8') as f:
    f.write(html_content)

print('index.html file has been created successfully.')
